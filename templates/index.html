{%extends "base.html"%} {%block content%}
<!-- ここの内側にbodyの中身をお願いします！！ -->
<h1>あなたのアイテム一覧</h1>
<div id="categoryFilters">
  <p>全て</p>
  {%for category in categories%}
      <p>{{category.name}}</p>
  {%endfor%}
</div>
<!-- 並び替え・絞り込み -->
<section class="controls">
  <select id="sortSelect">
    <option value="">並び替え</option>
    <option><a href="/items/search?sort=newest">新しい順</a></option>
    <option>
      <a href="/items/search?sort=num_items_desc">個数が多い順</a>
    </option>
    <option>
      <a href="/items/search?sort=num_items_asc">個数が少ない順</a>
    </option>
  </select>

  <select id="filterSelect">
    <option value="">カテゴリー</option>
    {% for category in categories%}
    <option value="{{category.name}}">{{category.name}}</option>
    {% endfor %}
  </select>
</section>

<section class="goods-list" id="goodsList">
  {% for item in items %} {% include "components/item_card.html" %} {% else %}
  <li>データがありません</li>
  {% endfor %}

  <!-- 後で書く際に参考したいので残しておきます
  
  <div class="card"
       data-name="ぱしゃこれ（かふか）"
       data-category="ぱしゃこれ,ランダム商品,18TRIP,大黒可不可"
       data-stock="14"
       data-image="images/goods4.jpg">
    <img src="images/goods4.jpg">
    <h2>ぱしゃこれ（かふか）</h2>
    <div class="tags">
      <span class="tag">#ぱしゃこれ</span>
      <span class="tag">#18TRIP</span>
      <span class="tag">#ランダム商品</span>
      <span class="tag">#大黒可不可</span>
    </div>
    <p>在庫：14個</p>
  </div>

  <div class="card"
       data-name="ぱしゃこれ（なぎ）"
       data-category="ぱしゃこれ,ランダム商品,18TRIP,蜂乃屋凪"
       data-stock="8"
       data-image="images/goods5.jpg">
    <img src="images/goods5.jpg">
    <h2>ぱしゃこれ（なぎ）</h2>
    <div class="tags">
      <span class="tag">#ぱしゃこれ</span>
      <span class="tag">#18TRIP</span>
      <span class="tag">#ランダム商品</span>
      <span class="tag">#蜂乃屋凪</span>
    </div>
    <p>在庫：8個</p>
  </div> -->
</section>
<div id="modalOverlay" class="overlay hidden"></div>

<script>
  const cards = Array.from(document.querySelectorAll(".card"));
  $(document).on("click", ".card", function () {
    const itemId = $(this).data("item-id");
    if (!itemId) {
      console.error("itemIdがありません");
      return;
    }
    $("#modalOverlay").removeClass("hidden");
    $("#modalOverlay").load(`/items/${itemId}/modal`); //ajaxで操作
    $(document).on("click", "#modalOverlay", function (e) {
      if (e.target.id === "modalOverlay") {
        $(this).addClass("hidden").empty();
      }
    });
  });

</script>

<style>
  .hidden {
    display: none;
  }
  /* ===== 並び替え・絞り込み ===== */
  .controls {
    display: flex;
    gap: 8px;
    margin-bottom: 20px;
  }

  .controls select {
    flex: 1; /* 横幅を均等に */
    height: 40px; /* 縦長防止 */
    padding: 0 10px; /* 縦paddingを消す */
    border-radius: 8px;
    border: 1px solid #ccc;
    font-size: 14px;
    background-color: #fff;

    white-space: nowrap; /* 文字折り返し防止 */
    -webkit-appearance: none;
    appearance: none;
  }
  #categoryFilters {
    background-color: #fff;
    padding: 10px;
    border-radius: 8px;
    display: flex;
    gap: 10px;
  }
  #categoryFilters p {
    background-color: #ffe1ec;
    color: #ff5f9e;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    cursor: pointer;
  }

  /* ===== グッズ一覧 ===== */
  .goods-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 16px;
  }

  /* ===== カード ===== */
  .card {
    background-color: white;
    border-radius: 14px;
    padding: 12px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    text-align: center;
  }

  .card img {
    width: 100%;
    height: 140px; /* 画像サイズ統一 */
    object-fit: cover; /* はみ出し防止 */
    border-radius: 10px;
  }

  .card h2 {
    font-size: 15px;
    margin: 8px 0 4px;
  }

  .card p {
    font-size: 13px;
    margin: 3px 0;
  }

  /* ===== ボトムナビ ===== */
  .bottom-nav {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 60px;
    background-color: #ffffff;
    display: flex;
    justify-content: space-around;
    align-items: center;
    border-top: 1px solid #ddd;
    box-shadow: 0 -2px 6px rgba(0, 0, 0, 0.1);
  }

  /* ===== タグ ===== */
  .tags {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    justify-content: center;
    margin-top: 6px;
  }

  .tag {
    font-size: 11px;
    padding: 4px 8px;
    border-radius: 999px;
    background-color: #ffe1ec;
    color: #ff5f9e;
  }

  /* ===== チェックボックス ===== */
  .filters {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 20px;
  }

  .filters label {
    font-size: 12px;
    padding: 6px 10px;
    border-radius: 20px;
    background-color: #fff;
    border: 1px solid #ddd;
    cursor: pointer;
  }

  .filters input {
    display: none;
  }

  .filters input:checked + span {
    color: white;
    background-color: #ff5f9e;
  }
  #modalOverlay {
  position: fixed;
  inset: 0;                
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  width: 100%;
  height: 100%;
  justify-content: center; 
  align-items: center;     
  z-index: 1000;
}
#modalOverlay.hidden {
  display: none;
}
</style>
<!-- ここまでです！！ -->
{%endblock%}
